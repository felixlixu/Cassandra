package org.apache.cassandra.net;

import java.net.InetAddress;

import org.apache.cassandra.service.StorageService;

public class Message {

	final Header header_;
	private byte[] body_;
	private final transient int version;
	
	public Message(Header header,byte[] body,int version){
		assert header !=null;
		assert body!=null;
		
		header_=header;
		body_=body;
		this.version=version;
	}
	
	public Message(InetAddress from,StorageService.Verb verb,byte[] body,int version){
		this(new Header(from,verb),body,version);
	}
	
	public byte[] getHeader(String key){
		return this.header_.getDetail(key);
	}
	
	public Message withHeaderAdded(String key,byte[] value){
		return new Message(header_.withDetailsAdded(key, value),body_,version);
	}
	
	public Message withHeaderRemoved(String key){
		return new Message(header_.withDetailsRemoved(key),body_,vaersion);
	}
	
	public InetAddress getFrom() {
		return header_.getFrom();
	}

	public StorageService.Verb getVerb() {
		return header_.getVerb();
	}

	public byte[] getMessageBody() {
		return body_;
	}

	public int getVersion() {
		return version;
	}

}
