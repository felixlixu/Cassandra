package org.apache.cassandra.db;

import java.io.DataInputStream;
import java.io.IOException;

import org.apache.cassandra.io.utils.FastByteArrayInputStream;
import org.apache.cassandra.net.IVerbHandler;
import org.apache.cassandra.net.Message;
import org.apache.cassandra.service.StorageService;

public class ReadVerbHandler implements IVerbHandler {

	@Override
	public void doVerb(Message message, String id) {
		if(StorageService.instance.isBootstrapMode()){
			throw new RuntimeException("Cannot service reads while bootstrapping!");
		}
		try{
			FastByteArrayInputStream in=new FastByteArrayInputStream(message.getMessageBody());
			ReadCommand command=ReadCommand.serializer().deserialize(new DataInputStream(in),message.getVersion());
			Table table=Table.open(command.table);
			Row row=command.getRow(table);
			
			ReadResponse response=getResponse(command,row);
			
		}catch(IOException ex){
			throw new RuntimeException(ex);
		}
	}

}
